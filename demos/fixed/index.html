<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Blockly Editor - ESP8266</title>
  <script src="../../blockly_compressed.js"></script>
  <script src="../../lua_compressed.js"></script>
  <script src="../../blocks/esp.js"></script>
  <script src="../../blocks_compressed.js"></script>
  <script src="../../msg/js/en.js"></script>
  <style>
    body {
      background-color: #fff;
      font-family: sans-serif;
    }
    h1 {
      font-weight: normal;
      font-size: 140%;
    }
  </style>
</head>
<body>
  <h1>Blockly Editor - ESP8266</h1>

  <p>Create your code here for use on the ESP8266. Select the code at the bottom for your program.</p>
  <div id="blocklyDiv" style="height: 480px; width: 1200px;"></div>

  <xml id="toolbox" style="display: none">
	<category name="Motors">
      <block type="esp_start_program"></block>
	  <block type="esp_drive_motor"></block>
	  <block type="esp_motor_setup"></block>
    </category>
	<category name="Other Input/Output">
	  <block type="esp_gpio_mode"></block>
	  <block type="esp_gpio_write"></block>
	  <block type="esp_gpio_read"></block>
	</category>
	<category name="Time">
	  <block type="esp_wait"></block>
	  <block type="esp_now"></block>
	  <!--<block type="esp_alarm"></block> There's something wrong with tmr.alarm() -->
	</category>
	<category name="Logic">
	  <block type="controls_if"></block>
	  <block type="controls_whileUntil"></block>
	  <block type="logic_compare"></block>
	  <block type="controls_repeat_ext"></block>
	  <block type="logic_boolean"></block>
	</category>
	<category name="Strings/Numbers">
	  <block type="math_number"></block>
	  <block type="math_arithmetic"></block>
	  <block type="text"></block>
	  <block type="text_print"></block>
	  <block type="text_join"></block>
	</category>
	<category name="Variables">
	  <block type="variables_set"></block>
	  <block type="variables_get"></block>
	</category>

	
  </xml>

  <script>
    var workspace = Blockly.inject('blocklyDiv',
        {media: '../../media/',
         toolbox: document.getElementById('toolbox')});
  </script>


  <textarea id="code" style="width:100%; height:100px" readonly="true"></textarea>

  <script>
	function myUpdateFunction(event) {
		var code = Blockly.Lua.workspaceToCode(workspace);
		//alert(code);
	    document.getElementById('code').textContent = code;
	}
	workspace.addChangeListener(myUpdateFunction);
  </script>

</body>
</html>
